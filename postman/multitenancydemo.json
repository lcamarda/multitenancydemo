{
	"info": {
		"_postman_id": "4d80fc87-e9a6-4001-b31c-a69f771c3418",
		"name": "Multi-Tenancy Demo",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Projects Creation",
			"item": [
				{
					"name": "Create project red",
					"request": {
						"auth": {
							"type": "basic",
							"basic": [
								{
									"key": "password",
									"value": "VMware1!VMware1!",
									"type": "string"
								},
								{
									"key": "username",
									"value": "admin",
									"type": "string"
								}
							]
						},
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "default"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"site_infos\": [\r\n        {\r\n            \"edge_cluster_paths\": [\r\n                \"/infra/sites/default/enforcement-points/default/edge-clusters/{{edge_cluster_id}}\"\r\n            ],\r\n            \"site_path\": \"/infra/sites/default\"\r\n        }\r\n    ],\r\n    \"tier_0s\": [\r\n        \"/infra/tier-0s/vrf-red\",\r\n        \"/infra/tier-0s/parent-t0\"\r\n    ],\r\n    \"resource_type\": \"Project\",\r\n    \"id\": \"project-red\",\r\n    \"display_name\": \"project-red\",\r\n    \"path\": \"/orgs/default/projects/project-red\"\r\n}"
						},
						"url": {
							"raw": "https://{{nsxmanager}}/policy/api/v1/orgs/default/projects/project-red",
							"protocol": "https",
							"host": [
								"{{nsxmanager}}"
							],
							"path": [
								"policy",
								"api",
								"v1",
								"orgs",
								"default",
								"projects",
								"project-red"
							]
						}
					},
					"response": []
				},
				{
					"name": "Create project blue",
					"request": {
						"auth": {
							"type": "basic",
							"basic": [
								{
									"key": "password",
									"value": "VMware1!VMware1!",
									"type": "string"
								},
								{
									"key": "username",
									"value": "admin",
									"type": "string"
								}
							]
						},
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "default"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"site_infos\": [\r\n        {\r\n            \"edge_cluster_paths\": [\r\n                \"/infra/sites/default/enforcement-points/default/edge-clusters/{{edge_cluster_id}}\"\r\n            ],\r\n            \"site_path\": \"/infra/sites/default\"\r\n        }\r\n    ],\r\n    \"tier_0s\": [\r\n        \"/infra/tier-0s/vrf-blue\",\r\n        \"/infra/tier-0s/parent-t0\"\r\n    ],\r\n    \"resource_type\": \"Project\",\r\n    \"id\": \"project-blue\",\r\n    \"display_name\": \"project-blue\",\r\n    \"path\": \"/orgs/default/projects/project-blue\"\r\n}"
						},
						"url": {
							"raw": "https://{{nsxmanager}}/policy/api/v1/orgs/default/projects/project-blue",
							"protocol": "https",
							"host": [
								"{{nsxmanager}}"
							],
							"path": [
								"policy",
								"api",
								"v1",
								"orgs",
								"default",
								"projects",
								"project-blue"
							]
						}
					},
					"response": []
				},
				{
					"name": "List_projects",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"auth": {
							"type": "basic",
							"basic": [
								{
									"key": "password",
									"value": "VMware1!VMware1!",
									"type": "string"
								},
								{
									"key": "username",
									"value": "admin",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "default"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"site_infos\": [\r\n        {\r\n            \"edge_cluster_paths\": [\r\n                \"/infra/sites/default/enforcement-points/default/edge-clusters/361c8d67-50a3-4ad9-9ad7-68b3961383a3\"\r\n            ],\r\n            \"site_path\": \"/infra/sites/default\"\r\n        }\r\n    ],\r\n    \"tier_0s\": [\r\n        \"/infra/tier-0s/Tier0GatewayPepsi\"\r\n    ],\r\n    \"resource_type\": \"Project\",\r\n    \"id\": \"Project1\",\r\n    \"display_name\": \"'Project1\",\r\n    \"path\": \"/orgs/default/projects/Project1\"\r\n}"
						},
						"url": {
							"raw": "https://{{nsxmanager}}/policy/api/v1/orgs/default/projects/",
							"protocol": "https",
							"host": [
								"{{nsxmanager}}"
							],
							"path": [
								"policy",
								"api",
								"v1",
								"orgs",
								"default",
								"projects",
								""
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Add Role Bindings for LDAP Users",
			"item": [
				{
					"name": "Set redadmin role to project admin for project red",
					"request": {
						"auth": {
							"type": "basic",
							"basic": [
								{
									"key": "password",
									"value": "VMware1!VMware1!",
									"type": "string"
								},
								{
									"key": "username",
									"value": "admin",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "default"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n\t\"name\": \"redadmin@corp.local\",\r\n    \"type\": \"remote_user\",\r\n    \"identity_source_type\": \"LDAP\",\r\n    \"identity_source_id\": \"ldap\",\r\n\t\"read_roles_for_paths\": true,\r\n\t\"roles_for_paths\": [\r\n    {\r\n      \"path\": \"/orgs/default/projects/project-red\",\r\n      \"roles\": [\r\n        {\r\n          \"role\": \"project_admin\"\r\n        }\r\n      ]\r\n    }\r\n  ]\r\n}"
						},
						"url": {
							"raw": "https://{{nsxmanager}}/policy/api/v1/aaa/role-bindings",
							"protocol": "https",
							"host": [
								"{{nsxmanager}}"
							],
							"path": [
								"policy",
								"api",
								"v1",
								"aaa",
								"role-bindings"
							]
						}
					},
					"response": []
				},
				{
					"name": "Set redsecurityadmin role to security admin for project red",
					"request": {
						"auth": {
							"type": "basic",
							"basic": [
								{
									"key": "password",
									"value": "VMware1!VMware1!",
									"type": "string"
								},
								{
									"key": "username",
									"value": "admin",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "default"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n\t\"name\": \"redsecurityadmin@corp.local\",\r\n    \"type\": \"remote_user\",\r\n    \"identity_source_type\": \"LDAP\",\r\n    \"identity_source_id\": \"ldap\",\r\n\t\"read_roles_for_paths\": true,\r\n\t\"roles_for_paths\": [\r\n    {\r\n      \"path\": \"/orgs/default/projects/project-red\",\r\n      \"roles\": [\r\n        {\r\n          \"role\": \"security_engineer\"\r\n        }\r\n      ]\r\n    }\r\n  ]\r\n}"
						},
						"url": {
							"raw": "https://{{nsxmanager}}/policy/api/v1/aaa/role-bindings",
							"protocol": "https",
							"host": [
								"{{nsxmanager}}"
							],
							"path": [
								"policy",
								"api",
								"v1",
								"aaa",
								"role-bindings"
							]
						}
					},
					"response": []
				},
				{
					"name": "Set rednetworkadmin role to network admin for project red",
					"request": {
						"auth": {
							"type": "basic",
							"basic": [
								{
									"key": "password",
									"value": "VMware1!VMware1!",
									"type": "string"
								},
								{
									"key": "username",
									"value": "admin",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "default"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n\t\"name\": \"rednetworkadmin@corp.local\",\r\n    \"type\": \"remote_user\",\r\n    \"identity_source_type\": \"LDAP\",\r\n    \"identity_source_id\": \"ldap\",\r\n\t\"read_roles_for_paths\": true,\r\n\t\"roles_for_paths\": [\r\n    {\r\n      \"path\": \"/orgs/default/projects/project-red\",\r\n      \"roles\": [\r\n        {\r\n          \"role\": \"network_engineer\"\r\n        }\r\n      ]\r\n    }\r\n  ]\r\n}"
						},
						"url": {
							"raw": "https://{{nsxmanager}}/policy/api/v1/aaa/role-bindings",
							"protocol": "https",
							"host": [
								"{{nsxmanager}}"
							],
							"path": [
								"policy",
								"api",
								"v1",
								"aaa",
								"role-bindings"
							]
						}
					},
					"response": []
				},
				{
					"name": "Set blueadmin role to project admin for project blue",
					"request": {
						"auth": {
							"type": "basic",
							"basic": [
								{
									"key": "password",
									"value": "VMware1!VMware1!",
									"type": "string"
								},
								{
									"key": "username",
									"value": "admin",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "default"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n\t\"name\": \"blueadmin@corp.local\",\r\n    \"type\": \"remote_user\",\r\n    \"identity_source_type\": \"LDAP\",\r\n    \"identity_source_id\": \"ldap\",\r\n\t\"read_roles_for_paths\": true,\r\n\t\"roles_for_paths\": [\r\n    {\r\n      \"path\": \"/orgs/default/projects/project-blue\",\r\n      \"roles\": [\r\n        {\r\n          \"role\": \"project_admin\"\r\n        }\r\n      ]\r\n    }\r\n  ]\r\n}"
						},
						"url": {
							"raw": "https://{{nsxmanager}}/policy/api/v1/aaa/role-bindings",
							"protocol": "https",
							"host": [
								"{{nsxmanager}}"
							],
							"path": [
								"policy",
								"api",
								"v1",
								"aaa",
								"role-bindings"
							]
						}
					},
					"response": []
				},
				{
					"name": "List Role bindings",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"auth": {
							"type": "basic",
							"basic": [
								{
									"key": "password",
									"value": "VMware1!VMware1!",
									"type": "string"
								},
								{
									"key": "username",
									"value": "admin",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "default"
							}
						],
						"body": {
							"mode": "raw",
							"raw": ""
						},
						"url": {
							"raw": "https://{{nsxmanager}}/api/v1/aaa/role-bindings",
							"protocol": "https",
							"host": [
								"{{nsxmanager}}"
							],
							"path": [
								"api",
								"v1",
								"aaa",
								"role-bindings"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Create Projects Topologies",
			"item": [
				{
					"name": "Create share for all projects",
					"request": {
						"auth": {
							"type": "basic",
							"basic": [
								{
									"key": "password",
									"value": "VMware1!VMware1!",
									"type": "string"
								},
								{
									"key": "username",
									"value": "admin",
									"type": "string"
								}
							]
						},
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "default"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"resource_type\": \"Share\",\r\n    \"sharedWith\": [\r\n        \"/orgs/default\"\r\n    ]\r\n}"
						},
						"url": {
							"raw": "https://{{nsxmanager}}/policy/api/v1/infra/shares/all_projects_share/",
							"protocol": "https",
							"host": [
								"{{nsxmanager}}"
							],
							"path": [
								"policy",
								"api",
								"v1",
								"infra",
								"shares",
								"all_projects_share",
								""
							]
						}
					},
					"response": []
				},
				{
					"name": "Share DHCP Relay Profile will all Projects",
					"request": {
						"auth": {
							"type": "basic",
							"basic": [
								{
									"key": "password",
									"value": "VMware1!VMware1!",
									"type": "string"
								},
								{
									"key": "username",
									"value": "admin",
									"type": "string"
								}
							]
						},
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "default"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"resource_objects\": [\r\n        {\r\n            \"resource_path\": \"/infra/dhcp-relay-configs/DHCPRelayControlCenter\",\r\n            \"include_children\": false\r\n        }\r\n    ]\r\n}"
						},
						"url": {
							"raw": "https://{{nsxmanager}}/policy/api/v1/infra/shares/all_projects_share/resources/dhcp_relay",
							"protocol": "https",
							"host": [
								"{{nsxmanager}}"
							],
							"path": [
								"policy",
								"api",
								"v1",
								"infra",
								"shares",
								"all_projects_share",
								"resources",
								"dhcp_relay"
							]
						}
					},
					"response": []
				},
				{
					"name": "Create project red T1 and segment HAPI",
					"request": {
						"auth": {
							"type": "basic",
							"basic": [
								{
									"key": "password",
									"value": "VMware1!VMware1!",
									"type": "string"
								},
								{
									"key": "username",
									"value": "admin",
									"type": "string"
								}
							]
						},
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "default"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"resource_type\": \"OrgRoot\",\r\n    \"children\": [\r\n        {\r\n            \"resource_type\": \"ChildResourceReference\",\r\n            \"id\": \"default\",\r\n            \"target_type\": \"Org\",\r\n            \"children\": [\r\n                {\r\n                    \"resource_type\": \"ChildProject\",\r\n                    \"Project\": {\r\n                        \"resource_type\": \"Project\",\r\n\t\t\t\t\t\t\"id\": \"project-red\",\r\n                        \"children\": [\r\n                            {\r\n                                \"resource_type\": \"ChildInfra\",\r\n                                \"Infra\": {\r\n                                    \"resource_type\": \"Infra\",\r\n                                    \"id\": \"infra\",\r\n                                    \"children\": [\r\n                                        {\r\n                                            \"Tier1\": {\r\n                                                \"tier0_path\": \"/infra/tier-0s/parent-t0\",\r\n                                                \"failover_mode\": \"NON_PREEMPTIVE\",\r\n                                                \"enable_standby_relocation\": false,\r\n                                                \"route_advertisement_types\": [\r\n                                                    \"TIER1_NAT\",\r\n                                                    \"TIER1_CONNECTED\"\r\n                                                ],\r\n                                                \"ha_mode\": \"ACTIVE_STANDBY\",\r\n                                                \"resource_type\": \"Tier1\",\r\n                                                \"id\": \"project-red-t1\",\r\n                                                \"display_name\": \"project-red-t1\",\r\n                                                \"children\": [\r\n                                                    \r\n                                                    {\r\n                                                        \"LocaleServices\": {\r\n                                                            \"edge_cluster_path\": \"/infra/sites/default/enforcement-points/default/edge-clusters/9d4c32ae-25f4-47ac-a98e-74c4832869b0\",\r\n                                                            \"resource_type\": \"LocaleServices\",\r\n                                                            \"id\": \"default\"\r\n                                                        },\r\n                                                        \"resource_type\": \"ChildLocaleServices\"\r\n                                                    }\r\n                                                ]\r\n                                            },\r\n                                            \"resource_type\": \"ChildTier1\",\r\n                                            \"id\": \"project-red-t1\"\r\n                                        },\r\n                                        {\r\n                                            \"Segment\": {\r\n                                                \"resource_type\": \"Segment\",\r\n                                                \"type\": \"ROUTED\",\r\n                                                \"subnets\": [\r\n                                                    {\r\n                                                        \"gateway_address\": \"172.16.30.1/24\",\r\n                                                        \"network\": \"172.16.30.0/24\"\r\n                                                    }\r\n                                                ],\r\n                                                \"connectivity_path\": \"/orgs/default/projects/project-red/infra/tier-1s/project-red-t1\",\r\n                                                \"dhcp_config_path\": \"/infra/dhcp-relay-configs/DHCPRelayControlCenter\",\r\n                                                \"id\": \"project-red-seg-01\",\r\n                                                \"display_name\": \"project-red-seg-01\"  \r\n                                            },\r\n                                            \"resource_type\": \"ChildSegment\",\r\n                                            \"id\": \"project-red-seg-01\"\r\n                                        }\r\n                                    ]\r\n                                }\r\n                            }\r\n                        ]\r\n                    }\r\n                }\r\n            ]\r\n        }\r\n    ]\r\n}"
						},
						"url": {
							"raw": "https://{{nsxmanager}}/policy/api/v1/org-root",
							"protocol": "https",
							"host": [
								"{{nsxmanager}}"
							],
							"path": [
								"policy",
								"api",
								"v1",
								"org-root"
							]
						}
					},
					"response": []
				},
				{
					"name": "Create project blue T1 and segment HAPI",
					"request": {
						"auth": {
							"type": "basic",
							"basic": [
								{
									"key": "password",
									"value": "VMware1!VMware1!",
									"type": "string"
								},
								{
									"key": "username",
									"value": "admin",
									"type": "string"
								}
							]
						},
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "default"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"resource_type\": \"OrgRoot\",\r\n    \"children\": [\r\n        {\r\n            \"resource_type\": \"ChildResourceReference\",\r\n            \"id\": \"default\",\r\n            \"target_type\": \"Org\",\r\n            \"children\": [\r\n                {\r\n                    \"resource_type\": \"ChildProject\",\r\n                    \"Project\": {\r\n                        \"resource_type\": \"Project\",\r\n\t\t\t\t\t\t\"id\": \"project-blue\",\r\n                        \"children\": [\r\n                            {\r\n                                \"resource_type\": \"ChildInfra\",\r\n                                \"Infra\": {\r\n                                    \"resource_type\": \"Infra\",\r\n                                    \"id\": \"infra\",\r\n                                    \"children\": [\r\n                                        {\r\n                                            \"Tier1\": {\r\n                                                \"tier0_path\": \"/infra/tier-0s/parent-t0\",\r\n                                                \"failover_mode\": \"NON_PREEMPTIVE\",\r\n                                                \"enable_standby_relocation\": false,\r\n                                                \"route_advertisement_types\": [\r\n                                                    \"TIER1_NAT\",\r\n                                                    \"TIER1_CONNECTED\"\r\n                                                ],\r\n                                                \"ha_mode\": \"ACTIVE_STANDBY\",\r\n                                                \"resource_type\": \"Tier1\",\r\n                                                \"id\": \"project-blue-t1\",\r\n                                                \"display_name\": \"project-blue-t1\",\r\n                                                \"children\": [\r\n                                                    \r\n                                                    {\r\n                                                        \"LocaleServices\": {\r\n                                                            \"edge_cluster_path\": \"/infra/sites/default/enforcement-points/default/edge-clusters/9d4c32ae-25f4-47ac-a98e-74c4832869b0\",\r\n                                                            \"resource_type\": \"LocaleServices\",\r\n                                                            \"id\": \"default\"\r\n                                                        },\r\n                                                        \"resource_type\": \"ChildLocaleServices\"\r\n                                                    }\r\n                                                ]\r\n                                            },\r\n                                            \"resource_type\": \"ChildTier1\",\r\n                                            \"id\": \"project-blue-t1\"\r\n                                        },\r\n                                        {\r\n                                            \"Segment\": {\r\n                                                \"resource_type\": \"Segment\",\r\n                                                \"type\": \"ROUTED\",\r\n                                                \"subnets\": [\r\n                                                    {\r\n                                                        \"gateway_address\": \"172.16.40.1/24\",\r\n                                                        \"network\": \"172.16.40.0/24\"\r\n                                                    }\r\n                                                ],\r\n                                                \"connectivity_path\": \"/orgs/default/projects/project-blue/infra/tier-1s/project-blue-t1\",\r\n                                                \"dhcp_config_path\": \"/infra/dhcp-relay-configs/DHCPRelayControlCenter\",\r\n                                                \"id\": \"project-blue-seg-01\",\r\n                                                \"display_name\": \"project-blue-seg-01\"  \r\n                                            },\r\n                                            \"resource_type\": \"ChildSegment\",\r\n                                            \"id\": \"project-blue-seg-01\"\r\n                                        }\r\n                                    ]\r\n                                }\r\n                            }\r\n                        ]\r\n                    }\r\n                }\r\n            ]\r\n        }\r\n    ]\r\n}"
						},
						"url": {
							"raw": "https://{{nsxmanager}}/policy/api/v1/org-root",
							"protocol": "https",
							"host": [
								"{{nsxmanager}}"
							],
							"path": [
								"policy",
								"api",
								"v1",
								"org-root"
							]
						}
					},
					"response": []
				},
				{
					"name": "Get ORG root tree",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"auth": {
							"type": "basic",
							"basic": [
								{
									"key": "password",
									"value": "VMware1!VMware1!",
									"type": "string"
								},
								{
									"key": "username",
									"value": "admin",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "default"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"site_infos\": [\r\n        {\r\n            \"edge_cluster_paths\": [\r\n                \"/infra/sites/default/enforcement-points/default/edge-clusters/361c8d67-50a3-4ad9-9ad7-68b3961383a3\"\r\n            ],\r\n            \"site_path\": \"/infra/sites/default\"\r\n        }\r\n    ],\r\n    \"tier_0s\": [\r\n        \"/infra/tier-0s/Tier0GatewayPepsi\"\r\n    ],\r\n    \"resource_type\": \"Project\",\r\n    \"id\": \"Project1\",\r\n    \"display_name\": \"'Project1\",\r\n    \"path\": \"/orgs/default/projects/Project1\"\r\n}"
						},
						"url": {
							"raw": "https://{{nsxmanager}}/policy/api/v1/org-root?base_path=/orgs/default",
							"protocol": "https",
							"host": [
								"{{nsxmanager}}"
							],
							"path": [
								"policy",
								"api",
								"v1",
								"org-root"
							],
							"query": [
								{
									"key": "base_path",
									"value": "/orgs/default"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "HAPI per project",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"auth": {
							"type": "basic",
							"basic": [
								{
									"key": "password",
									"value": "VMware1!",
									"type": "string"
								},
								{
									"key": "username",
									"value": "redadmin@corp.local",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "default"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"site_infos\": [\r\n        {\r\n            \"edge_cluster_paths\": [\r\n                \"/infra/sites/default/enforcement-points/default/edge-clusters/361c8d67-50a3-4ad9-9ad7-68b3961383a3\"\r\n            ],\r\n            \"site_path\": \"/infra/sites/default\"\r\n        }\r\n    ],\r\n    \"tier_0s\": [\r\n        \"/infra/tier-0s/Tier0GatewayPepsi\"\r\n    ],\r\n    \"resource_type\": \"Project\",\r\n    \"id\": \"Project1\",\r\n    \"display_name\": \"'Project1\",\r\n    \"path\": \"/orgs/default/projects/Project1\"\r\n}"
						},
						"url": {
							"raw": "https://{{nsxmanager}}/policy/api/v1/orgs/default/projects/project-red/infra?filter=Type-",
							"protocol": "https",
							"host": [
								"{{nsxmanager}}"
							],
							"path": [
								"policy",
								"api",
								"v1",
								"orgs",
								"default",
								"projects",
								"project-red",
								"infra"
							],
							"query": [
								{
									"key": "filter",
									"value": "Type-"
								}
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Create Projects DFW Security Policies",
			"item": [
				{
					"name": "Create red vm group based on name *vm*",
					"request": {
						"auth": {
							"type": "basic",
							"basic": [
								{
									"key": "password",
									"value": "VMware1!VMware1!",
									"type": "string"
								},
								{
									"key": "username",
									"value": "admin",
									"type": "string"
								}
							]
						},
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "default"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"expression\": [\r\n      {\r\n        \"member_type\": \"VirtualMachine\",\r\n        \"value\": \"vm\",\r\n        \"key\": \"Name\",\r\n        \"operator\": \"CONTAINS\",\r\n        \"resource_type\": \"Condition\"\r\n      }\r\n    ],\r\n    \"display_name\": \"redvmgroup\"\r\n}"
						},
						"url": {
							"raw": "https://{{nsxmanager}}/policy/api/v1/orgs/default/projects/project-red/infra/domains/default/groups/redvmgroup",
							"protocol": "https",
							"host": [
								"{{nsxmanager}}"
							],
							"path": [
								"policy",
								"api",
								"v1",
								"orgs",
								"default",
								"projects",
								"project-red",
								"infra",
								"domains",
								"default",
								"groups",
								"redvmgroup"
							]
						}
					},
					"response": []
				},
				{
					"name": "Create blue vm group based on name *vm*",
					"request": {
						"auth": {
							"type": "basic",
							"basic": [
								{
									"key": "password",
									"value": "VMware1!VMware1!",
									"type": "string"
								},
								{
									"key": "username",
									"value": "admin",
									"type": "string"
								}
							]
						},
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "default"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"expression\": [\r\n      {\r\n        \"member_type\": \"VirtualMachine\",\r\n        \"value\": \"vm\",\r\n        \"key\": \"Name\",\r\n        \"operator\": \"CONTAINS\",\r\n        \"resource_type\": \"Condition\"\r\n      }\r\n    ],\r\n    \"display_name\": \"bluevmgroup\"\r\n}"
						},
						"url": {
							"raw": "https://{{nsxmanager}}/policy/api/v1/orgs/default/projects/project-blue/infra/domains/default/groups/bluevmgroup",
							"protocol": "https",
							"host": [
								"{{nsxmanager}}"
							],
							"path": [
								"policy",
								"api",
								"v1",
								"orgs",
								"default",
								"projects",
								"project-blue",
								"infra",
								"domains",
								"default",
								"groups",
								"bluevmgroup"
							]
						}
					},
					"response": []
				},
				{
					"name": "Create  vm group in the default space based on name *vm*",
					"request": {
						"auth": {
							"type": "basic",
							"basic": [
								{
									"key": "password",
									"value": "VMware1!VMware1!",
									"type": "string"
								},
								{
									"key": "username",
									"value": "admin",
									"type": "string"
								}
							]
						},
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "default"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"expression\": [\r\n      {\r\n        \"member_type\": \"VirtualMachine\",\r\n        \"value\": \"vm\",\r\n        \"key\": \"Name\",\r\n        \"operator\": \"CONTAINS\",\r\n        \"resource_type\": \"Condition\"\r\n      }\r\n    ],\r\n    \"display_name\": \"allprojectsvmgroup\"\r\n}"
						},
						"url": {
							"raw": "https://{{nsxmanager}}/policy/api/v1/infra/domains/default/groups/allprojectsvmgroup",
							"protocol": "https",
							"host": [
								"{{nsxmanager}}"
							],
							"path": [
								"policy",
								"api",
								"v1",
								"infra",
								"domains",
								"default",
								"groups",
								"allprojectsvmgroup"
							]
						}
					},
					"response": []
				},
				{
					"name": "Create base access policy for all project VMs",
					"request": {
						"auth": {
							"type": "basic",
							"basic": [
								{
									"key": "password",
									"value": "VMware1!VMware1!",
									"type": "string"
								},
								{
									"key": "username",
									"value": "admin",
									"type": "string"
								}
							]
						},
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "default"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"display_name\": \"project-VMs-basic-access\",\r\n    \"category\": \"Application\",\r\n    \"rules\": [\r\n      {\r\n        \"display_name\": \"Access-to-project-VMs\",\r\n        \"sequence_number\": 1,\r\n        \"source_groups\": [\r\n          \"192.168.110.10/32\"\r\n        ],\r\n        \"destination_groups\": [\r\n          \"/infra/domains/default/groups/allprojectsvmgroup\"\r\n        ],\r\n        \"services\": [\r\n          \"/infra/services/HTTP\",\r\n          \"/infra/services/ICMP-ALL\",\r\n          \"/infra/services/SSH\"\r\n        ],\r\n        \"action\": \"ALLOW\",\r\n        \"scope\": [\r\n                \"/infra/domains/default/groups/allprojectsvmgroup\"\r\n            ]\r\n      },\r\n      {\r\n        \"display_name\": \"DNS-access-from-project-VMs\",\r\n        \"sequence_number\": 2,\r\n        \"destination_groups\": [\r\n          \"192.168.110.10/32\"\r\n        ],\r\n        \"source_groups\": [\r\n          \"/infra/domains/default/groups/allprojectsvmgroup\"\r\n        ],\r\n        \"services\": [\r\n          \"/infra/services/DNS-UDP\",\r\n          \"/infra/services/DNS\"\r\n        ],\r\n        \"action\": \"ALLOW\",\r\n        \"scope\": [\r\n                \"/infra/domains/default/groups/allprojectsvmgroup\"\r\n            ]\r\n      }\r\n    ]\r\n}"
						},
						"url": {
							"raw": "https://{{nsxmanager}}/policy/api/v1/infra/domains/default/security-policies/project-infra",
							"protocol": "https",
							"host": [
								"{{nsxmanager}}"
							],
							"path": [
								"policy",
								"api",
								"v1",
								"infra",
								"domains",
								"default",
								"security-policies",
								"project-infra"
							]
						}
					},
					"response": []
				},
				{
					"name": "Create a project red specific policy to ping control center",
					"request": {
						"auth": {
							"type": "basic",
							"basic": [
								{
									"key": "password",
									"value": "VMware1!",
									"type": "string"
								},
								{
									"key": "username",
									"value": "redadmin@corp.local",
									"type": "string"
								}
							]
						},
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "default"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"display_name\": \"project-red-policy01\",\r\n    \"category\": \"Application\",\r\n    \"rules\": [\r\n      {\r\n        \"display_name\": \"ping-controlcenter\",\r\n        \"sequence_number\": 1,\r\n        \"destination_groups\": [\r\n          \"192.168.110.10/32\"\r\n        ],\r\n        \"source_groups\": [\r\n          \"ANY\"\r\n        ],\r\n        \"services\": [\r\n          \"/infra/services/ICMP-ALL\"\r\n        ],\r\n        \"action\": \"ALLOW\"\r\n      }\r\n    ]\r\n}"
						},
						"url": {
							"raw": "https://{{nsxmanager}}/policy/api/v1/orgs/default/projects/project-red/infra/domains/default/security-policies/project-red-policy01",
							"protocol": "https",
							"host": [
								"{{nsxmanager}}"
							],
							"path": [
								"policy",
								"api",
								"v1",
								"orgs",
								"default",
								"projects",
								"project-red",
								"infra",
								"domains",
								"default",
								"security-policies",
								"project-red-policy01"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Connect VLAN to red T1 via SI",
			"item": [
				{
					"name": "Create VLAN 166 segment on edge TZ",
					"request": {
						"auth": {
							"type": "basic",
							"basic": [
								{
									"key": "password",
									"value": "VMware1!VMware1!",
									"type": "string"
								},
								{
									"key": "username",
									"value": "admin",
									"type": "string"
								}
							]
						},
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "default"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"display_name\":\"vlan166\",\r\n    \"vlan_ids\": [166],\r\n    \"transport_zone_path\": \"/infra/sites/default/enforcement-points/default/transport-zones/082c0e4e-5417-4467-ac27-9ddc48287847\"\r\n  }"
						},
						"url": {
							"raw": "https://{{nsxmanager}}/policy/api/v1/infra/segments/vlan166",
							"protocol": "https",
							"host": [
								"{{nsxmanager}}"
							],
							"path": [
								"policy",
								"api",
								"v1",
								"infra",
								"segments",
								"vlan166"
							]
						}
					},
					"response": []
				},
				{
					"name": "Create share specific to project red",
					"request": {
						"auth": {
							"type": "basic",
							"basic": [
								{
									"key": "password",
									"value": "VMware1!VMware1!",
									"type": "string"
								},
								{
									"key": "username",
									"value": "admin",
									"type": "string"
								}
							]
						},
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "default"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"resource_type\": \"Share\",\r\n    \"sharedWith\": [\r\n        \"/orgs/default/projects/project-red\"\r\n    ]\r\n}"
						},
						"url": {
							"raw": "https://{{nsxmanager}}/policy/api/v1/infra/shares/project_red_share/",
							"protocol": "https",
							"host": [
								"{{nsxmanager}}"
							],
							"path": [
								"policy",
								"api",
								"v1",
								"infra",
								"shares",
								"project_red_share",
								""
							]
						}
					},
					"response": []
				},
				{
					"name": "Share VLAN166 with project red",
					"request": {
						"auth": {
							"type": "basic",
							"basic": [
								{
									"key": "password",
									"value": "VMware1!VMware1!",
									"type": "string"
								},
								{
									"key": "username",
									"value": "admin",
									"type": "string"
								}
							]
						},
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "default"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"resource_objects\": [\r\n        {\r\n            \"resource_path\": \"/infra/segments/vlan166\",\r\n            \"include_children\": false\r\n        }\r\n    ]\r\n}"
						},
						"url": {
							"raw": "https://{{nsxmanager}}/policy/api/v1/infra/shares/project_red_share/resources/vlan166",
							"protocol": "https",
							"host": [
								"{{nsxmanager}}"
							],
							"path": [
								"policy",
								"api",
								"v1",
								"infra",
								"shares",
								"project_red_share",
								"resources",
								"vlan166"
							]
						}
					},
					"response": []
				},
				{
					"name": "Connect VLAN 166 segment to red T1 SI",
					"request": {
						"auth": {
							"type": "basic",
							"basic": [
								{
									"key": "password",
									"value": "VMware1!VMware1!",
									"type": "string"
								},
								{
									"key": "username",
									"value": "admin",
									"type": "string"
								}
							]
						},
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "default"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"resource_type\": \"OrgRoot\",\r\n    \"children\": [\r\n        {\r\n            \"resource_type\": \"ChildResourceReference\",\r\n            \"id\": \"default\",\r\n            \"target_type\": \"Org\",\r\n            \"children\": [\r\n                {\r\n                    \"resource_type\": \"ChildProject\",\r\n                    \"Project\": {\r\n                        \"resource_type\": \"Project\",\r\n                        \"id\": \"project-red\",\r\n                        \"children\": [\r\n                            {\r\n                                \"resource_type\": \"ChildInfra\",\r\n                                \"Infra\": {\r\n                                    \"resource_type\": \"Infra\",\r\n                                    \"id\": \"infra\",\r\n                                    \"children\": [\r\n                                        {\r\n                                            \"Tier1\": {\r\n                                                \"tier0_path\": \"/infra/tier-0s/parent-t0\",\r\n                                                \"failover_mode\": \"NON_PREEMPTIVE\",\r\n                                                \"enable_standby_relocation\": false,\r\n                                                \"route_advertisement_types\": [\r\n                                                    \"TIER1_NAT\",\r\n                                                    \"TIER1_CONNECTED\"\r\n                                                ],\r\n                                                \"ha_mode\": \"ACTIVE_STANDBY\",\r\n                                                \"resource_type\": \"Tier1\",\r\n                                                \"id\": \"project-red-t1\",\r\n                                                \"display_name\": \"project-red-t1\",\r\n                                                \"children\": [\r\n                                                    {\r\n                                                        \"LocaleServices\": {\r\n                                                            \"edge_cluster_path\": \"/infra/sites/default/enforcement-points/default/edge-clusters/9d4c32ae-25f4-47ac-a98e-74c4832869b0\",\r\n                                                            \"resource_type\": \"LocaleServices\",\r\n                                                            \"id\": \"default\",\r\n                                                            \"children\": [\r\n                                                                {\r\n                                                                    \"Tier1Interface\": {\r\n                                                                        \"segment_path\": \"/infra/segments/vlan166\",\r\n                                                                        \"resource_type\": \"Tier1Interface\",\r\n                                                                        \"id\": \"vlan166\",\r\n                                                                        \"subnets\": [\r\n                                                                            {\r\n                                                                                \"ip_addresses\": [\r\n                                                                                    \"172.16.166.1\"\r\n                                                                                ],\r\n                                                                                \"prefix_len\": 24\r\n                                                                            }\r\n                                                                        ]\r\n                                                                        \r\n                                                                    },\r\n                                                                    \"resource_type\": \"ChildTier1Interface\",\r\n                                                                    \"id\": \"vlan166\"\r\n                                                                }\r\n                                                            ]\r\n                                                        },\r\n                                                        \"resource_type\": \"ChildLocaleServices\"\r\n                                                    }\r\n                                                ]\r\n                                            },\r\n                                            \"resource_type\": \"ChildTier1\",\r\n                                            \"id\": \"project-red-t1\"\r\n                                        }\r\n                                    ]\r\n                                }\r\n                            }\r\n                        ]\r\n                    }\r\n                }\r\n            ]\r\n        }\r\n    ]\r\n}"
						},
						"url": {
							"raw": "https://{{nsxmanager}}/policy/api/v1/org-root",
							"protocol": "https",
							"host": [
								"{{nsxmanager}}"
							],
							"path": [
								"policy",
								"api",
								"v1",
								"org-root"
							]
						}
					},
					"response": []
				}
			]
		}
	]
}
